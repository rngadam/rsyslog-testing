$ModLoad omrelp
$ModLoad imfile

$ActionFileDefaultTemplate RSYSLOG_SyslogProtocol23Format
$ActionForwardDefaultTemplate RSYSLOG_SyslogProtocol23Format

$WorkDirectory /tmp

$ActionQueueType LinkedList   # use asynchronous processing
$ActionQueueFileName srvrfwd  # set file name, also enables disk mode
$ActionResumeRetryCount -1    # infinite retries on insert failure
$ActionQueueSaveOnShutdown on # save in-memory data if rsyslog shuts down

$InputFileName /tmp/imfile
$InputFilePollInterval 1
$InputFileTag tag1:
$InputFileStateFile /tmp/imfile.state
$InputFileSeverity error
$InputFileFacility local7
# without this line, won't start!
$InputRunFileMonitor

# target host
*.* :omrelp:127.0.0.1:5014;RSYSLOG_SyslogProtocol23Format